<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.dong.boardMapper">

	<!-- 상품 상세 정보 -->
	<select id="productDetail" parameterType="java.lang.Integer" resultType="productDTO">
		select *
		from product 
		where product_code = #{product_code}
	</select>
	
	<!-- 카테고리 리스트 -->
	<select id="categoryList" parameterType="map" resultType="ProductDTO">
		select *
		from product
		order by product_regdate desc
		limit #{start}, #{pageSize} 
	</select>
	
	<!-- 카테고리 페이징 -->
	<select id="categoryTotalPost" resultType="java.lang.Integer">
		select count(*) from product;
	</select>
	
	<!-- 공지사항 리스트 -->
	<select id="noticeList" parameterType="map" resultType="NoticeDTO">
		select *
		from notice
		order by notice_no desc
       	limit #{start}, #{pageSize}
	</select>
	 
	<!-- 공지사항 페이징 -->
	<select id="noticeTotalPost" resultType="java.lang.Integer">
		select count(*) from notice;
	</select>
	
	<!-- 리뷰 리스트 -->
	<select id="reviewList" parameterType="map" resultType="ReviewDTO">
		select r.*, p.product_name
		from review r left join product p on r.product_code = p.product_code
		
		order by review_no desc
       	limit #{start}, #{pageSize}
	</select>
	
	<!-- 리뷰 페이징 -->
	<select id="reviewTotalPost" resultType="java.lang.Integer">
		select count(*) from review;
	</select>
	
	<!-- Q&A 리스트 -->
	<select id="qnaList" parameterType="map" resultType="QnaDTO">
		select *
		from qna
		order by qna_no desc
       	limit #{start}, #{pageSize}
	</select>
	 
	<!-- Q&A 페이징 -->
	<select id="qnaTotalPost" resultType="java.lang.Integer">
		select count(*) from qna;
	</select>
	
	<!-- FAQ 리스트 -->
 	<select id="faqList" parameterType="map" resultType="FaqDTO">
		select *
		from faq
		order by faq_no desc
       	limit #{start}, #{pageSize}
	</select>
	
	<!-- FAQ 페이징 -->
	<select id="faqTotalPost" resultType="java.lang.Integer">
		select count(*) from faq;
	</select>
	
	<!-- FAQ 구분 리스트 -->
	<select id="faqTotalPostDivision" parameterType="java.lang.Integer" resultType="java.lang.Integer">
	    SELECT COUNT(*) 
	    FROM faq
	    WHERE faq_division = #{faq_division}
	</select>
	
	<!-- FAQ 구분 페이징 -->
	<select id="faqListDivision" parameterType="map" resultType="FaqDTO">
	    SELECT *
	    FROM faq
	    WHERE faq_division = #{faq_division}
	    ORDER BY faq_no DESC
	    LIMIT #{start}, #{pageSize}
	</select>
	
	<!-- 공지사항 상세 글 조회  -->
	<select id="noticeDetail" parameterType="java.lang.Integer" resultType="NoticeDTO">
		select *
		from notice
		where notice_no = #{notice_no}
	</select>
	
	<!-- 공지사항 조회수 1 증가하는 SQL -->
	<update id="noticeUpdateReadCnt" parameterType="java.lang.Integer">
		update notice
		set notice_readcnt = notice_readcnt + 1
		where notice_no = #{notice_no}
	</update>
	
	<!-- 리뷰 상세 글 조회 -->
	<select id="reviewDetail" parameterType="java.lang.Integer" resultType="ReviewDTO">
		select r.*, p.product_name
		from review r left join product p on r.product_code = p.product_code
		where review_no = #{review_no}
	</select>
	
	<!-- 리뷰 조회수 1 증가하는 SQL -->
	<update id="reviewUpdateReadCnt" parameterType="java.lang.Integer">
		update review
		set review_readcnt = review_readcnt + 1
		where review_no = #{review_no}
	</update>
	
	<!-- Q&A 상세 글 조회 -->
	<select id="qnaDetail" parameterType="java.lang.Integer" resultType="QnaDTO">
		select q.*, p.product_name
		from qna q left join product p on q.product_code_fk = p.product_code
		where q.qna_no = #{qna_no}
	</select>
	
	<!-- 공지사항 글 작성하는 SQL -->
	<insert id="noticeRegister" parameterType="NoticeDTO">
		insert into notice(notice_no, notice_title, notice_content, notice_date, notice_readcnt, admin_pwd)
		values (#{notice_no}, #{notice_title}, #{notice_content}, curdate(), #{notice_readcnt}, #{admin_pwd})		
	</insert>
	
	<!-- 공지사항 글 수정하는 SQL -->
	<update id="noticeUpdate" parameterType="NoticeDTO">
		update notice
		set notice_title = #{notice_title}, notice_content = #{notice_content}, admin_pwd = #{admin_pwd}
		where notice_no = #{notice_no}
	</update>
	
	<!-- 공지사항 글 삭제하는 SQL -->
	<update id="noticeDelete" parameterType="java.lang.Integer">
		delete from notice
		where notice_no = #{notice_no}
	</update>
	
	<!-- Q&A 글 작성하는 SQL -->
	<insert id="qnaRegister" parameterType="QnaDTO">
		insert into qna(qna_no, product_group_id_fk2, user_id, qna_content, qna_secret, qna_date, qna_reply)
		values (#{qna_no}, #{product_group_id_fk2}, #{user_id}, #{qna_content}, false, curdate(), #{qna_reply})		
	</insert>
	
	<!-- Q&A 글 수정하는 SQL -->
	<update id="qnaUpdate" parameterType="QnaDTO">
		update qna
		set qna_content=#{qna_content}, qna_date=curdate()
		where qna_no = #{qna_no}
	</update>
	
	<!-- Q&A 글 삭제하는 SQL -->
	<update id="qnaDelete" parameterType="java.lang.Integer">
		delete from qna
		where qna_no = #{qna_no}
	</update>
	
		<!-- FAQ 글 작성하는 SQL -->
	<insert id="faqRegister" parameterType="FaqDTO">
		insert into faq(faq_no, faq_division, faq_question, faq_reply, admin_pwd)
		values (#{faq_no}, #{faq_division}, #{faq_question}, #{faq_reply}, #{admin_pwd})		
	</insert>
	
	<!-- FAQ 글 수정하는 SQL -->
	<update id="faqUpdate" parameterType="FaqDTO">
		update faq
		set faq_content=#{faq_content}
		where faq_no = #{faq_no}
	</update>
	
	<!-- FAQ 글 삭제하는 SQL -->
	<update id="faqDelete" parameterType="java.lang.Integer">
		delete from faq
		where faq_no = #{faq_no}
	</update>
</mapper>
  
  
  
  
  
  
  
  
  